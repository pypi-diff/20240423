# Comparing `tmp/meteva_base-0.2.0-py3-none-any.whl.zip` & `tmp/meteva_base-0.2.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,26 +1,26 @@
-Zip file size: 2830407 bytes, number of entries: 120
+Zip file size: 2831075 bytes, number of entries: 120
 -rw-rw-rw-  2.0 fat      198 b- defN 23-Jun-15 10:03 meteva_base/__init__.py
 -rw-rw-rw-  2.0 fat      189 b- defN 24-Mar-29 09:52 meteva_base/basicdata/__init__.py
 -rw-rw-rw-  2.0 fat     6187 b- defN 24-Mar-29 11:26 meteva_base/basicdata/check_out.py
 -rw-rw-rw-  2.0 fat     1199 b- defN 24-Apr-03 03:31 meteva_base/basicdata/const.py
 -rw-rw-rw-  2.0 fat     7385 b- defN 23-Jun-15 10:01 meteva_base/basicdata/ctl.py
 -rw-rw-rw-  2.0 fat    19260 b- defN 23-Jun-15 10:01 meteva_base/basicdata/dicts.py
--rw-rw-rw-  2.0 fat     9954 b- defN 24-Apr-02 10:40 meteva_base/basicdata/grid.py
--rw-rw-rw-  2.0 fat    33301 b- defN 24-Apr-03 03:31 meteva_base/basicdata/grid_data.py
+-rw-rw-rw-  2.0 fat    10053 b- defN 24-Apr-23 14:21 meteva_base/basicdata/grid.py
+-rw-rw-rw-  2.0 fat    34690 b- defN 24-Apr-23 14:51 meteva_base/basicdata/grid_data.py
 -rw-rw-rw-  2.0 fat      669 b- defN 23-Jun-15 10:01 meteva_base/basicdata/keys_raw.py
--rw-rw-rw-  2.0 fat     9850 b- defN 24-Apr-03 10:42 meteva_base/basicdata/sta_data.py
+-rw-rw-rw-  2.0 fat    10266 b- defN 24-Apr-23 14:25 meteva_base/basicdata/sta_data.py
 -rw-rw-rw-  2.0 fat     3190 b- defN 24-Jan-04 11:31 meteva_base/basicdata/utils.py
 -rw-rw-rw-  2.0 fat      557 b- defN 23-Aug-03 23:41 meteva_base/fun/__init__.py
 -rw-rw-rw-  2.0 fat    30100 b- defN 23-Aug-04 02:34 meteva_base/fun/combining.py
 -rw-rw-rw-  2.0 fat    28472 b- defN 23-Jun-15 10:01 meteva_base/fun/computing.py
 -rw-rw-rw-  2.0 fat    18666 b- defN 23-Jul-17 08:28 meteva_base/fun/diagnosing.py
 -rw-rw-rw-  2.0 fat    28327 b- defN 23-Jun-15 10:01 meteva_base/fun/funs.py
 -rw-rw-rw-  2.0 fat    29984 b- defN 23-Jun-15 10:01 meteva_base/fun/grouping.py
--rw-rw-rw-  2.0 fat    34323 b- defN 24-Jan-31 07:13 meteva_base/fun/interpolating.py
+-rw-rw-rw-  2.0 fat    34701 b- defN 24-Apr-23 14:12 meteva_base/fun/interpolating.py
 -rw-rw-rw-  2.0 fat    14420 b- defN 23-Jun-15 10:01 meteva_base/fun/nearing.py
 -rw-rw-rw-  2.0 fat    50875 b- defN 23-Jun-15 10:01 meteva_base/fun/selecting.py
 -rw-rw-rw-  2.0 fat    39746 b- defN 23-Jul-17 08:38 meteva_base/fun/statisticing.py
 -rw-rw-rw-  2.0 fat    10698 b- defN 23-Jun-15 10:01 meteva_base/fun/timing.py
 -rw-rw-rw-  2.0 fat     7047 b- defN 23-Jun-15 10:01 meteva_base/fun/transformating.py
 -rw-rw-rw-  2.0 fat      494 b- defN 23-Jun-15 10:01 meteva_base/function/__init__.py
 -rw-rw-rw-  2.0 fat     2451 b- defN 23-Jun-15 10:01 meteva_base/function/get_from_grid_data.py
@@ -48,15 +48,15 @@
 -rw-rw-rw-  2.0 fat    17194 b- defN 23-Jun-15 10:01 meteva_base/io/ftpconn.py
 -rw-rw-rw-  2.0 fat     1771 b- defN 23-Jun-15 10:01 meteva_base/io/httpclient.py
 -rw-rw-rw-  2.0 fat     8190 b- defN 23-Jun-15 10:01 meteva_base/io/httpconn.py
 -rw-rw-rw-  2.0 fat     4882 b- defN 23-Jun-15 10:01 meteva_base/io/loglib.py
 -rw-rw-rw-  2.0 fat     6048 b- defN 23-Jun-15 10:01 meteva_base/io/print_grib_info.py
 -rw-rw-rw-  2.0 fat    20392 b- defN 23-Jun-15 10:01 meteva_base/io/read_graphydata.py
 -rw-rw-rw-  2.0 fat   120112 b- defN 24-Apr-02 08:56 meteva_base/io/read_griddata.py
--rw-rw-rw-  2.0 fat   106054 b- defN 24-Apr-03 10:42 meteva_base/io/read_stadata.py
+-rw-rw-rw-  2.0 fat   106295 b- defN 24-Apr-23 12:59 meteva_base/io/read_stadata.py
 -rw-rw-rw-  2.0 fat     4673 b- defN 23-Jun-15 10:01 meteva_base/io/write_array.py
 -rw-rw-rw-  2.0 fat    10883 b- defN 24-Jan-02 04:23 meteva_base/io/write_griddata.py
 -rw-rw-rw-  2.0 fat    16031 b- defN 24-Apr-03 10:42 meteva_base/io/write_stadata.py
 -rw-rw-rw-  2.0 fat     1770 b- defN 23-Jun-15 10:01 meteva_base/resources/colormaps/color_rain_1h.bak.txt
 -rw-rw-rw-  2.0 fat     1510 b- defN 23-Jun-15 10:01 meteva_base/resources/colormaps/color_rain_1h.txt
 -rw-rw-rw-  2.0 fat     2135 b- defN 23-Jun-15 10:01 meteva_base/resources/colormaps/color_rain_1h_error.txt
 -rw-rw-rw-  2.0 fat      169 b- defN 23-Jun-15 10:01 meteva_base/resources/colormaps/color_rain_24h.txt
@@ -110,13 +110,13 @@
 -rw-rw-rw-  2.0 fat    19533 b- defN 23-Dec-22 03:07 meteva_base/tool/path_tools.py
 -rw-rw-rw-  2.0 fat   174805 b- defN 23-Jun-15 10:01 meteva_base/tool/plot_tools.py
 -rw-rw-rw-  2.0 fat    33260 b- defN 23-Jul-10 09:08 meteva_base/tool/plot_tools_adv.py
 -rw-rw-rw-  2.0 fat     4851 b- defN 23-Jun-15 10:01 meteva_base/tool/process_tools.py
 -rw-rw-rw-  2.0 fat     4585 b- defN 23-Jun-15 10:01 meteva_base/tool/station_tools.py
 -rw-rw-rw-  2.0 fat    11665 b- defN 23-Dec-22 07:52 meteva_base/tool/time_tools.py
 -rw-rw-rw-  2.0 fat    13625 b- defN 23-Dec-22 08:16 meteva_base/tool/trainselect_tools.py
--rw-rw-rw-  2.0 fat     1088 b- defN 24-Apr-03 10:46 meteva_base-0.2.0.dist-info/LICENSE
--rw-rw-rw-  2.0 fat      756 b- defN 24-Apr-03 10:46 meteva_base-0.2.0.dist-info/METADATA
--rw-rw-rw-  2.0 fat       97 b- defN 24-Apr-03 10:46 meteva_base-0.2.0.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       12 b- defN 24-Apr-03 10:46 meteva_base-0.2.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat    11176 b- defN 24-Apr-03 10:46 meteva_base-0.2.0.dist-info/RECORD
-120 files, 7874259 bytes uncompressed, 2812551 bytes compressed:  64.3%
+-rw-rw-rw-  2.0 fat     1088 b- defN 24-Apr-23 14:56 meteva_base-0.2.1.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat      756 b- defN 24-Apr-23 14:56 meteva_base-0.2.1.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       97 b- defN 24-Apr-23 14:56 meteva_base-0.2.1.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       12 b- defN 24-Apr-23 14:56 meteva_base-0.2.1.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat    11178 b- defN 24-Apr-23 14:56 meteva_base-0.2.1.dist-info/RECORD
+120 files, 7876784 bytes uncompressed, 2813219 bytes compressed:  64.3%
```

## zipnote {}

```diff
@@ -339,23 +339,23 @@
 
 Filename: meteva_base/tool/time_tools.py
 Comment: 
 
 Filename: meteva_base/tool/trainselect_tools.py
 Comment: 
 
-Filename: meteva_base-0.2.0.dist-info/LICENSE
+Filename: meteva_base-0.2.1.dist-info/LICENSE
 Comment: 
 
-Filename: meteva_base-0.2.0.dist-info/METADATA
+Filename: meteva_base-0.2.1.dist-info/METADATA
 Comment: 
 
-Filename: meteva_base-0.2.0.dist-info/WHEEL
+Filename: meteva_base-0.2.1.dist-info/WHEEL
 Comment: 
 
-Filename: meteva_base-0.2.0.dist-info/top_level.txt
+Filename: meteva_base-0.2.1.dist-info/top_level.txt
 Comment: 
 
-Filename: meteva_base-0.2.0.dist-info/RECORD
+Filename: meteva_base-0.2.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## meteva_base/basicdata/grid.py

```diff
@@ -55,32 +55,32 @@
         #提取时间维度信息
         # try:
         if gtime is None:
             self.stime = np.datetime64('2020-01-01T00:00:00.000000')
             self.etime = np.datetime64('2020-01-01T00:00:00.000000')
             self.dtime_int = 1
             self.dtime_type = "h"
-            self.times = pd.date_range(self.stime, self.etime, freq=str(self.dtime_int)+self.dtime_type ).to_pydatetime()#[datetime]
+            self.gtime = pd.date_range(self.stime, self.etime, freq=str(self.dtime_int)+self.dtime_type ).to_pydatetime()#[datetime]
         else:
             try:
                 _ = len(gtime)
             except:
                 gtime = [gtime]
             if len(gtime) == 1:
-                self.times = meteva_base.basicdata.utils.get_time_input_single(gtime)
+                self.gtime = meteva_base.basicdata.utils.get_time_input_single(gtime)
 
             elif len(gtime) ==3 and isinstance(gtime[2],str) and len(gtime[2])<=5:
-                self.times = meteva_base.basicdata.utils.get_time_input_three(gtime)
+                self.gtime = meteva_base.basicdata.utils.get_time_input_three(gtime)
 
             else:
                 if isinstance(gtime[0], datetime.datetime):
-                    self.times = gtime
+                    self.gtime = gtime
                 else:
-                    self.times = [meteva_base.all_type_time_to_datetime(dt) for dt in gtime]#[datetime]
-        self.stime_str = self.times[0].strftime("%y%m%d%H%M")
+                    self.gtime = [meteva_base.all_type_time_to_datetime(dt) for dt in gtime]#[datetime]
+        self.stime_str = self.gtime[0].strftime("%y%m%d%H%M")
         # except Exception as err:
             # print('gtime ERROR: ',err)
         ############################################################################
         #提取预报时效维度信息
         if dtime_list is None:
             self.dtimes = [0]
         else:
@@ -152,15 +152,15 @@
         :return:  string
         '''
         grid_str = ""
         grid_str += "## grid_coordinates ##" + "\n"
         grid_str += "members:" + str(self.members) +"\n"
         grid_str += "levels:" + str(self.levels) + "\n"
         # grid_str += "gtime:" + str([self.stime_str,self.etime_str,self.dtime_str]) + "\n"
-        grid_str += "gtime:" + str(self.times)  +"\n"
+        grid_str += "gtime:" + str(self.stime_str)  +"\n"
         grid_str += "dtimes:" + str(self.dtimes)  +"\n"
         grid_str += "glon:" + str(self.glon) + "\n"
         grid_str += "glat:" + str(self.glat) + "\n"
         grid_str += "## grid_attributes ##" +  "\n"
         grid_str += "units:" + str(self.units) + "\n"
         grid_str += "model_var:" + str(self.model_var) + "\n"
         grid_str += "dtime_units:" + str(self.dtime_units) + "\n"
@@ -200,28 +200,29 @@
     lons = grid_data0['lon'].values
     dlon = get_true_value(lons[1] - lons[0])
     glon = [get_true_value(lons[0]), get_true_value(lons[-1]), dlon]
     lats = grid_data0['lat'].values
     dlat = get_true_value(lats[1] - lats[0])
     glat = [get_true_value(lats[0]), get_true_value(lats[-1]), dlat]
 
-    units_attr       = grid_data0.attrs['units']
-    model_var_attr   = grid_data0.attrs['model_var']
-    dtime_units_attr = grid_data0.attrs['dtime_units']
-    level_type_attr  = grid_data0.attrs['level_type']
-    time_type_attr   = grid_data0.attrs['time_type']
-    time_bounds_attr = grid_data0.attrs['time_bounds']
+    # units_attr       = grid_data0.attrs['units']
+    # model_var_attr   = grid_data0.attrs['model_var']
+    # dtime_units_attr = grid_data0.attrs['dtime_units']
+    # level_type_attr  = grid_data0.attrs['level_type']
+    # time_type_attr   = grid_data0.attrs['time_type']
+    # time_bounds_attr = grid_data0.attrs['time_bounds']
+    units,model,dtime_units,level_type,time_type,time_bounds = meteva_base.basicdata.get_griddata_attrs(grid_data0)
 
     grid01 = grid(glon, glat, gtime, gdt, level_list, member_list,
-                        units_attr      = units_attr,
-                        model_var_attr  = model_var_attr,
-                        dtime_units_attr= dtime_units_attr,
-                        level_type_attr = level_type_attr,
-                        time_type_attr  = time_type_attr,
-                        time_bounds_attr= time_bounds_attr)
+                        units_attr      = units,
+                        model_var_attr  = model,
+                        dtime_units_attr= dtime_units,
+                        level_type_attr = level_type,
+                        time_type_attr  = time_type,
+                        time_bounds_attr= time_bounds)
     return grid01
 
 
 def reset_grid(grid0):
     if grid0.dlat <0:
         grid0.dlat = - grid0.dlat
         tran = grid0.slat
```

## meteva_base/basicdata/grid_data.py

```diff
@@ -14,15 +14,15 @@
     slat = grid.slat
     dlat = grid.dlat
     nlon = grid.nlon
     nlat = grid.nlat
     # 通过起始经纬度和格距计算经纬度格点数
     lon = np.arange(nlon) * dlon + slon
     lat = np.arange(nlat) * dlat + slat
-    times = pd.DatetimeIndex(grid.times)
+    times = pd.DatetimeIndex(grid.gtime)
     ntime = len(times)
     # 根据timedelta的格式，算出ndt次数和gds时效列表
 
     ndt = len(grid.dtimes)
     gdt_list = grid.dtimes
 
     level_list = grid.levels
@@ -180,33 +180,74 @@
         
         return units,model,dtime_units,level_type,time_type,time_bounds
     
     except Exception as ex:
         raise ex
 
 def set_griddata_attrs(grd, units = None, model_var = None, dtime_units =None,
-            level_type=None ,time_type=None , time_bounds=None):
+            level_type=None ,time_type=None , time_bounds=None,
+            is_default=False,
+            default_attr={'units':'', 'model_var':'', 'dtime_units':'hour', 'level_type':'isobaric', 'time_type':'UT', 'time_bounds':[0,0],}
+            ):
     """
     :param units_attr:       属性，数据单位，string类型，默认为None
     :param model_var:        属性，数据来源(模式及要素)，string类型，默认为None
     :param dtime_units_attr: 属性，预报时效，hour/minute
     :param level_type_attr:  属性，高度单位类型，isobaric/attitude
     :param time_type_attr:   属性，预报时效，UT/BT
     :param time_bounds_attr: 属性，要素起止时间，list类型，默认为[0,0]。如1小时降水为[-1,0]
+    :is_default:             属性赋值方式，True: 属性为None则赋值属性为默认值； False:属性为None则不赋值该属性
+    :default_attr:           默认属性值, is_default为True时生效
     """
     if grd.attrs is None: grd.attrs = {}
-    if units is not None       : grd.attrs['units'] = units
-    if model_var is not None   : grd.attrs['model_var'] = model_var
-    if dtime_units is not None : grd.attrs['dtime_units'] = dtime_units
-    if level_type is not None  : grd.attrs['level_type'] = level_type
-    if time_type is not None   : grd.attrs['time_type'] = time_type
-    if time_bounds is not None : grd.attrs['time_bounds'] = time_bounds
+
+    if units is not None       : 
+        grd.attrs['units'] = units
+    else:
+        if is_default:
+            grd.attrs['units'] = default_attr['units']
+
+    if model_var is not None   : 
+        grd.attrs['model_var'] = model_var
+    else:
+        if is_default:
+            grd.attrs['model_var'] = default_attr['model_var']
+
+    if dtime_units is not None : 
+        grd.attrs['dtime_units'] = dtime_units
+    else:
+        if is_default:
+            grd.attrs['dtime_units'] = default_attr['dtime_units']
+
+    if level_type is not None  : 
+        grd.attrs['level_type'] = level_type
+    else:
+        if is_default:
+            grd.attrs['level_type'] = default_attr['level_type']
+
+    if time_type is not None   : 
+        grd.attrs['time_type'] = time_type
+    else:
+        if is_default:
+            grd.attrs['time_type'] = default_attr['time_type']
+
+    if time_bounds is not None : 
+        grd.attrs['time_bounds'] = time_bounds
+    else:
+        if is_default:
+            grd.attrs['time_bounds'] = default_attr['time_bounds']
     return None
 
-    
+
+
+def set_griddata_attrs_same(grd, grd0):
+    units,model,dtime_units,level_type,time_type,time_bounds = get_griddata_attrs(grd0)
+    set_griddata_attrs(grd, units = units, model_var = model, dtime_units =dtime_units,
+            level_type=level_type ,time_type=time_type , time_bounds=time_bounds)
+    return None
     
 
 def xarray_to_griddata(xr0,
                        value_name=None, member_dim=None, level_dim=None, time_dim=None, dtime_dim=None, lat_dim=None,
                        lon_dim=None
                        ):
     da = None
```

## meteva_base/basicdata/sta_data.py

```diff
@@ -10,15 +10,16 @@
              # var_units="", valid_time=0, data_start_columns=6,
              reset_ids = True,
              units_attr      = '',#数据单位
              model_var_attr  = '',#补充模式/要素信息
              dtime_units_attr= 'hour',# hour/minite
              level_type_attr = 'isobaric',# isobaric/attitude
              time_type_attr  = 'UT',#UT/BT
-             time_bounds_attr= [0,0],#数据起止时间
+             time_bounds_attr= [0,0],#数据起止时间,
+             is_dtype_conv   = True
              ):
     '''
     sta_data() 对数据进行格式化成为固定格式
     :param df: dataframe的站点数据
     :param columns: 文件内包含的数据的列名
     :return: 包含‘level', 'time', 'dtime', 'id', 'lon', 'lat',  列的一个dataframe
     '''
@@ -57,17 +58,18 @@
     if len(sta.columns) == 6:
         sta["data0"] =0
     else:
         #for i in range(6,len(sta.columns)):
         #    sta.iloc[:,i] = (sta.values[:,i]).astype(np.float32)
         pass
 
-    set_stadata_attrs(sta,units_attr = units_attr,model_var_attr = model_var_attr,dtime_units_attr = dtime_units_attr,
-                      level_type_attr = level_type_attr,time_type_attr = time_type_attr,time_bounds_attr = time_bounds_attr,)
-    sta=set_stadata_coords_dtype(sta)
+    set_stadata_attrs(sta,units = units_attr, model_var = model_var_attr, dtime_units = dtime_units_attr,
+                      level_type = level_type_attr, time_type = time_type_attr, time_bounds = time_bounds_attr)
+    if is_dtype_conv:
+        sta=set_stadata_coords_dtype(sta)
     return sta
 
 def set_stadata_attrs(sta, units = None, model_var = None, dtime_units =None,
              level_type = None, time_type = None,
              time_bounds = None):
 
     if sta.attrs is None: sta.attrs = {}
@@ -259,22 +261,30 @@
             time_bounds=default_time_bounds
         
         return units,model,dtime_units,level_type,time_type,time_bounds
     
     except Exception as ex:
         raise ex
 
-def set_stadata_coords_dtype(sta):
+def set_stadata_coords_dtype(sta,
+                            level_type=np.int16,
+                            dtime_type=np.int16,
+                            id_type=np.int32,
+                            lat_type=np.float64,
+                            lon_type=np.float64,
+                            data_type = np.float32
+    ):
     sta0=sta.copy()
-    sta0['time']=pd.to_datetime(sta0['time'])
-    sta0['level']=sta0['level'].astype('float32')
-    sta0['dtime']=sta0['dtime'].astype('int32')
-    sta0['id']=sta0['id'].astype('int32')
-    sta0['lon']=sta0['level'].astype('float32')
-    sta0['lat']=sta0['level'].astype('float32')
     try:
+        sta0['level']=sta0['level'].astype(level_type)
+        sta0['time']=pd.to_datetime(sta0['time'])
+        sta0['dtime']=sta0['dtime'].astype(dtime_type)
+        sta0['id']=sta0['id'].astype(id_type)
+        sta0['lon']=sta0['lon'].astype(lon_type)
+        sta0['lat']=sta0['lat'].astype(lat_type)
         for column in sta0:
             if column  not in ['id','level','time','dtime','lon','lat']:
-                sta0[column]=sta0[column].astype('float32')
+                sta0[column]=sta0[column].astype(data_type)
     except Exception as ex:
+        print("ERROR in stadata dtype convert!")
         print(ex)
     return sta0
```

## meteva_base/fun/interpolating.py

```diff
@@ -554,15 +554,15 @@
                     return None
                 is_out = True
 
         if is_out:
             grid_new0 = meteva_base.get_inner_grid(grid,grid0)
             grid_new = meteva_base.grid(grid_new0.glon, grid_new0.glat, grid0.gtime, grid0.dtimes, grid0.levels, grid0.members)
         else:
-            grid_new = meteva_base.grid(grid.glon, grid.glat, grid0.times, grid0.dtimes, grid0.levels, grid0.members)
+            grid_new = meteva_base.grid(grid.glon, grid.glat, grid0.gtime, grid0.dtimes, grid0.levels, grid0.members)
         grd_new = meteva_base.grid_data(grid_new)
         for i in range(len(levels)):
             for j in range(len(times)):
                 for k in range(len(dtimes)):
                     for m in range(len(members)):
                         # 六维转换为二维的值
                         dat = grd.values[m,i,j,k,:,:]
@@ -730,7 +730,16 @@
         return -dx * (dx - 1) * (dx - 2) / 6
     elif (n == 0):
         return (dx + 1) * (dx - 1) * (dx - 2) / 2
     elif (n == 1):
         return -(dx + 1) * dx * (dx - 2) / 2
     else:
         return (dx + 1) * dx * (dx - 1) / 6
+
+
+
+# if __name__ == "__main__":
+#     import meteva_base as meb0
+#     grd = meb0.read_griddata_from_nc(r"H:\temp\202301_zhinengwangge\20230206_unitycode\git\24042200.024.nc")
+#     sta0 = meb0.read_stadata_from_micaps3(r"\\10.20.90.107\Observation\R24_national\sfc\20240423\h24_202404230000.m3",show=True)
+#     sta1 = meb0.interp_gs_linear(grd, sta0)
+#     print(sta0)
```

## meteva_base/io/read_stadata.py

```diff
@@ -123,15 +123,15 @@
 
             sta1 = pd.read_csv(file_sta, skiprows=skip_num, sep="\s+", header=None, usecols=[0, 1, 2, 3])
             sta1.columns = ['id', 'lon', 'lat', 'alt']
             sta1.drop_duplicates(keep='first', inplace=True)
             if drop_same_id:
                 sta1 = sta1.drop_duplicates(['id'])
             # sta = bd.sta_data(sta1)
-            sta = meteva_base.basicdata.sta_data(sta1)
+            sta = meteva_base.basicdata.sta_data(sta1, is_dtype_conv=False)#不强制数据类型统一
             # print(sta)
 
             y2 = ""
             if len(strs[3]) == 2:
                 year = int(strs[3])
                 if year >= 50:
                     y2 = '19'
@@ -228,15 +228,15 @@
             file_sta = open(filename, 'r',encoding=encoding)
             sta1 = pd.read_csv(file_sta, skiprows=skip_num, sep="\s+", header=None, usecols=[0, 1, 2, 4])
             sta1.columns = ['id', 'lon', 'lat', data_name]
             sta1.drop_duplicates(keep='first', inplace=True)
             if drop_same_id:
                 sta1 = sta1.drop_duplicates(['id'])
             # sta = bd.sta_data(sta1)
-            sta = meteva_base.basicdata.sta_data(sta1)
+            sta = meteva_base.basicdata.sta_data(sta1, is_dtype_conv=False)
             #print(sta)
 
             y2 = ""
             if len(strs[3]) == 2:
                 year = int(strs[3])
                 if year >= 50:
                     y2 = '19'
@@ -267,16 +267,16 @@
             units,model,dtime_units,level_type,time_type,time_bounds=get_stadata_attrs(sta)
             set_stadata_attrs(sta,units = units,
                               model_var = model,
                               dtime_units = dtime_units,
                               level_type = level_type
                               ,time_type = time_type,
                               time_bounds = time_bounds)
+            sta=set_stadata_coords_dtype(sta)
             return sta
-
         except:
             if show:
                 exstr = traceback.format_exc()
                 print(exstr)
 
             print(filename+"文件格式不能识别。可能原因：文件未按micaps3格式存储")
             return None
@@ -338,15 +338,15 @@
                 #         sta1.loc[i, 'lon'] = a
             # if "lat" in station_column:
             #     for i in range(nsta):
             #         if sta1.loc[i, 'lat'] > 1000:
             #             a = sta1.loc[i, 'lat'] // 100 + (a % 100) / 60
             #             sta1.loc[i, 'lat'] = a
             # sta = bd.sta_data(sta1)
-            sta = meteva_base.basicdata.sta_data(sta1)
+            sta = meteva_base.basicdata.sta_data(sta1, is_dtype_conv=False)
             if drop_same_id:
                 sta = sta.drop_duplicates(['id'])
 
             # sta['time'] = method.time_tools.str_to_time64("2099010108")
             if time is not None:
                 sta.loc[:,"time"] = time
             elif pd.isnull(sta.iloc[0,1]):
@@ -440,15 +440,15 @@
 
             f = StringIO(strs_all)
             df = pd.read_csv(f,header = None,sep="\s+")
             df = df.loc[:,[0,1,2,6,6 + element_id]]
             df.columns = ["id", "lon", "lat", "dtime",data_name]
             df["time"] = time_file
             df["level"] = level
-            sta = meteva_base.sta_data(df)
+            sta = meteva_base.sta_data(df, is_dtype_conv=False)
             sta.attrs = {}
             units,model,dtime_units,level_type,time_type,time_bounds=get_stadata_attrs(sta)
             set_stadata_attrs(sta,units = units,
                               model_var = model,
                               dtime_units = dtime_units,
                               level_type = level_type
                               ,time_type = time_type,
@@ -482,15 +482,15 @@
             print("文件编码格式不识别")
             return None
 
         try:
             file = open(filename,encoding=encoding)
             sta1 = pd.read_csv(file, skiprows=2, sep="\s+", header=None, usecols=[0, 1, 2,  column])
             sta1.columns = ['id', 'lon', 'lat', data_name]
-            sta2 = meteva_base.basicdata.sta_data(sta1)
+            sta2 = meteva_base.basicdata.sta_data(sta1, is_dtype_conv=False)
             if drop_same_id:
                 sta2 = sta2.drop_duplicates(['id'])
             strs0 = heads[0].split()
             strs = heads[1].split()
             y2 = ""
             if len(strs[0]) == 2:
                 year = int(strs[0])
@@ -571,15 +571,15 @@
         try:
             file = open(filename, encoding=encoding)
             sta1 = pd.read_csv(file, skiprows=2, sep="\s+", header=None, usecols=[0, 1, 4,5,column])
             sta1.columns = ['id','time', 'lon', 'lat', data_name]
             sta1['time'] = pd.to_datetime(sta1['time'],format="%Y%m%d%H%M%S%f")
             if not keep_millisecond:
                 sta1['time'] = sta1['time'].dt.ceil("S")
-            sta2 = meteva_base.basicdata.sta_data(sta1)
+            sta2 = meteva_base.basicdata.sta_data(sta1, is_dtype_conv=False)
 
             sta2.loc[:, "level"] = level
             sta2.loc[:, "dtime"] = 0
             sta2.attrs = {}
             if show:
                 print("success read from " + filename)
             units,model,dtime_units,level_type,time_type,time_bounds=get_stadata_attrs(sta2)
@@ -1818,15 +1818,15 @@
                 dat[:,1] = row2[:]
                 dat[:,2] = row1[:]
             else:
                 dat[:,1] = row1[:]
                 dat[:,2] = row2[:]
             dat[:,3] = row3[:]
             station = pd.DataFrame(dat, columns=['id','lon', 'lat', data_name])
-            station = meteva_base.sta_data(station)
+            station = meteva_base.sta_data(station, is_dtype_conv=False)
             meteva_base.set_stadata_coords(station,level=level,time= time,dtime = dtime)
             station.attrs = {}
             units,model,dtime_units,level_type,time_type,time_bounds=get_stadata_attrs(station)
             set_stadata_attrs(station,units = units,
                               model_var = model,
                               dtime_units = dtime_units,
                               level_type = level_type
@@ -2092,15 +2092,15 @@
             return None
 
         # construct pandas DataFrame
         df = pd.DataFrame(contents['DS'])
         data1 =df.iloc[0,3]
         if isinstance(data1,str):
             df[element] = df[element].astype("float")
-        sta = meteva_base.sta_data(df,columns=["id","lon","lat",element])
+        sta = meteva_base.sta_data(df,columns=["id","lon","lat",element], is_dtype_conv=False)
 
         #sta.time = pd.to_datetime(sta.time)
         #sta.level = sta.level.astype(np.int16)
         sta.id = sta.id.astype(np.int32)
         #sta.dtime = sta.dtime.astype(np.int16)
         sta.lon = sta.lon.astype(np.float32)
         sta.lat = sta.lat.astype(np.float32)
```

## Comparing `meteva_base-0.2.0.dist-info/LICENSE` & `meteva_base-0.2.1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `meteva_base-0.2.0.dist-info/METADATA` & `meteva_base-0.2.1.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: meteva-base
-Version: 0.2.0
+Version: 0.2.1
 Summary: base classes and functions of generally meteorogical usage, like Basic_class/IO/calculation/plot .etc
 Home-page: https://github.com/guoyunqian/meteva_base
 Author: NMC_WFT
 Author-email: pangzide003@163.com
 License: MIT
 Requires-Dist: numpy (>=1.12.1)
 Requires-Dist: pandas (<=2.0.3,>=1.0.4)
```

## Comparing `meteva_base-0.2.0.dist-info/RECORD` & `meteva_base-0.2.1.dist-info/RECORD`

 * *Files 3% similar despite different names*

```diff
@@ -1,25 +1,25 @@
 meteva_base/__init__.py,sha256=wcfMIjydnihx2RHyA-f_jJ5oegivrv4MMgu9RbNQbl4,198
 meteva_base/basicdata/__init__.py,sha256=zo9xQZFlEmDbrXg4J3ppRjgbLNylQWctkFSttHH19d4,189
 meteva_base/basicdata/check_out.py,sha256=2meZYVFTY-4aIrFgoVFxmVFkqVgm_UnbCROcGrdL9tw,6187
 meteva_base/basicdata/const.py,sha256=i2Nhceka5f--K91YTvq_8czTONpl0kjT0Ewb2DIiB3Q,1199
 meteva_base/basicdata/ctl.py,sha256=wPxWMdW3lXqLtrfk8JGttWCj5ydc-aQJqAC8I2gN8yI,7385
 meteva_base/basicdata/dicts.py,sha256=bbmKu4InhIay4ajS8jdbcbYlhgnqmVWVNOWcsuqFOVE,19260
-meteva_base/basicdata/grid.py,sha256=_Qv30AT54N-hU8k2nizkhm1uJDsP5Rm87CsJDnkqqD8,9954
-meteva_base/basicdata/grid_data.py,sha256=beFVr_BOz4Iu_-jw1vfojrKF_ET5NUNVyCkxidIQUX0,33301
+meteva_base/basicdata/grid.py,sha256=e73pLaOMP5Vmwzu6vaerVk_SjHs51-nfGr1083xkFN4,10053
+meteva_base/basicdata/grid_data.py,sha256=yuov6stYpo9eEB4nPecPO5ozhjKMZBRpxwsDL3t7YBc,34690
 meteva_base/basicdata/keys_raw.py,sha256=p013KCaFZjFbfY1-LT0b1JzwfxIs1hsVUufAR15PIFs,669
-meteva_base/basicdata/sta_data.py,sha256=TowJeUYG4ooPV59Y7G6oGe_wrF9bWNEtkBPy-kf35io,9850
+meteva_base/basicdata/sta_data.py,sha256=5R3bodQr-d2hXWxIuWvIBAWvSQ44IRkJ4FzDZ9JYhrA,10266
 meteva_base/basicdata/utils.py,sha256=rPf_5hFxjTrRteoIvkzpLHRijoBYKQ_YuNPAmvbmRNE,3190
 meteva_base/fun/__init__.py,sha256=i-kuo4hicsPSfVmlFlkaAyCH75ojhzWwN2IRmVFROy8,557
 meteva_base/fun/combining.py,sha256=MlokZHJY_wGap3pvvd78sCGFLoxQ-yUmXNpdF_9s-0c,30100
 meteva_base/fun/computing.py,sha256=iccESjMoTQ9QmkYHFagyyksa0YaEgBY4TO00ob3tNc4,28472
 meteva_base/fun/diagnosing.py,sha256=BcxvMSoysUPt124o1Eub1jhAk7t6ctFaL_2eYmkY6wA,18666
 meteva_base/fun/funs.py,sha256=gUoG5MIjpETJ1EHNNgq11pjmFxYeD_es7lL86jQWznc,28327
 meteva_base/fun/grouping.py,sha256=3LRHtJ0BK90NApAoR6QoQVyTZwNCj9k3dfkLzNHfIOU,29984
-meteva_base/fun/interpolating.py,sha256=21yLFyxLbTb9hmtDejHmxKqURTG4ll7PKjAhLbLGX9c,34323
+meteva_base/fun/interpolating.py,sha256=YuUZ8fpmaY4qHJgJuDi8dNHk6e5oKRjlcEO4riPYv9w,34701
 meteva_base/fun/nearing.py,sha256=8l5JRrLJvZNGZ_f0YrHT6k9e44JyzFP8Z9xeP_Ro3Lg,14420
 meteva_base/fun/selecting.py,sha256=_LtqSkfN8GKU60wPWi9fNCr2aQcT7n5osPN5swKknJc,50875
 meteva_base/fun/statisticing.py,sha256=UK_LdQYbzHgp-ZOyfnUJlJC9yP1R157xcIsGsNVWrsA,39746
 meteva_base/fun/timing.py,sha256=zfDGtSkm3aytdWxMo5cqShFOztHr695j5VtCCInNusg,10698
 meteva_base/fun/transformating.py,sha256=UZsxepzFmnOM4Y8Jqa-42QFZ1JWGvMAJBbqypuojxto,7047
 meteva_base/function/__init__.py,sha256=AF0FlnQBGShyGerPl0HKJs7oEuTzcrVnDZsxWI0oVm0,494
 meteva_base/function/get_from_grid_data.py,sha256=_rweYJ1h349ECnX3_8qWM0B_pJVa3X3Se05pGk3F24M,2451
@@ -47,15 +47,15 @@
 meteva_base/io/ftpconn.py,sha256=E4Si0Z0DfX9tzaHB-rIqhLsQLHOuZ35HyaUlEnrVn-A,17194
 meteva_base/io/httpclient.py,sha256=T9IXCSqUsOD9F9_a1RE9uxSrNQUa2B0h8LcOdTrOEbc,1771
 meteva_base/io/httpconn.py,sha256=pRQCR8czqMEG_d1WxSNrQNF2tUtt2Mt7UGabnARHHww,8190
 meteva_base/io/loglib.py,sha256=Lp36FeWRrpsTX08yZTClo5xx833u7bqsz7QhB0-FRBg,4882
 meteva_base/io/print_grib_info.py,sha256=3_glDTwVASA8CMwcqwO0KnQDi47i-qeXuba4w_BNieg,6048
 meteva_base/io/read_graphydata.py,sha256=hbID5RaOEVESEIz1WScNvEEfIN62NEgpb8ff9voYvWU,20392
 meteva_base/io/read_griddata.py,sha256=hbyJc5REaIJ_dpJAZ6tx26RAdPrbeSLKkI4IbQ2m3L4,120112
-meteva_base/io/read_stadata.py,sha256=mXCr5bTpCJSL_w9U4KEANDYICbMiJd_SSYuzl2NkcFM,106054
+meteva_base/io/read_stadata.py,sha256=08GUhBJukYWWtmmuuKZixfCXyH0ikN9JYwFAJdEZSSM,106295
 meteva_base/io/write_array.py,sha256=Y455dtYJjhYLHhwHHczC4qPxNiVtLexzo0QVjVpJQGs,4673
 meteva_base/io/write_griddata.py,sha256=B-trHiI2dl8Fx8TmF5MRNR9G8-JN_Zo_-HEV4SOrsL4,10883
 meteva_base/io/write_stadata.py,sha256=-9ppa2tkOKiPFA2wUeQv2oByuy_VIr5yBisURNwcP3E,16031
 meteva_base/resources/colormaps/color_rain_1h.bak.txt,sha256=6n8y6T59ODR2IP2WYsWFApHyn6PP2LWjzozVczWQVos,1770
 meteva_base/resources/colormaps/color_rain_1h.txt,sha256=27TYNH-9rjnKQJsKz3mApK79XxntaFZi4bb28d-oO40,1510
 meteva_base/resources/colormaps/color_rain_1h_error.txt,sha256=b9Yp8q6E1ij-ZQVWa-FaQ4_FvSdZaQ6wuJDPfw9GEgY,2135
 meteva_base/resources/colormaps/color_rain_24h.txt,sha256=EdZQBVJe2B9KjwiWE3doj7X8Xlm1rDfrb0mSr2fK60w,169
@@ -109,12 +109,12 @@
 meteva_base/tool/path_tools.py,sha256=i9_FVoBiC03Ks-vm2jJpWCVHqhWf5f250sqDC2XoDK0,19533
 meteva_base/tool/plot_tools.py,sha256=13gxGqBMrP2v5EH3ogO76GVzbzULia8g5HcEKoY2SrE,174805
 meteva_base/tool/plot_tools_adv.py,sha256=Ftmfr0yooDWJ3ZKPxj3rBZWfOYGSnAcOSyitd3dxgx8,33260
 meteva_base/tool/process_tools.py,sha256=DpKhLfb-NV0GUQQb3Gi_eG2xIUpCKtHWacB71KDUWJY,4851
 meteva_base/tool/station_tools.py,sha256=N61VKYuSsAhsOMq8DHnpt10ys16T7KmQLW67dfzx_4c,4585
 meteva_base/tool/time_tools.py,sha256=b2VkgtgERsBrp9v8ymn5byegA3abuPHGHEAaQl5AB78,11665
 meteva_base/tool/trainselect_tools.py,sha256=D5-5aMu7RoGZbRwvx0-RhBqAxg_h7Rix_DgZiHc3oe4,13625
-meteva_base-0.2.0.dist-info/LICENSE,sha256=z0xmWp4Kv-GgoTzOTiDre2ifAxS10t4O9py6gXsAVMU,1088
-meteva_base-0.2.0.dist-info/METADATA,sha256=9aUDpOPpzFiSe_j_9qy6U_AkGUiHFbxRKoX4gcFK-8I,756
-meteva_base-0.2.0.dist-info/WHEEL,sha256=D1Wh14kWDxPnrM-5t_6UCB-UuQNrEODtRa3vF4OsvQY,97
-meteva_base-0.2.0.dist-info/top_level.txt,sha256=9xoeyXk97X89uUwYj_XV9UeCopr5XPlyacoJqhTh03k,12
-meteva_base-0.2.0.dist-info/RECORD,,
+meteva_base-0.2.1.dist-info/LICENSE,sha256=z0xmWp4Kv-GgoTzOTiDre2ifAxS10t4O9py6gXsAVMU,1088
+meteva_base-0.2.1.dist-info/METADATA,sha256=bNnbVQovj_MSbV71r5B2MWHMYuCHSNn98kOnBfo-Xzo,756
+meteva_base-0.2.1.dist-info/WHEEL,sha256=D1Wh14kWDxPnrM-5t_6UCB-UuQNrEODtRa3vF4OsvQY,97
+meteva_base-0.2.1.dist-info/top_level.txt,sha256=9xoeyXk97X89uUwYj_XV9UeCopr5XPlyacoJqhTh03k,12
+meteva_base-0.2.1.dist-info/RECORD,,
```

